---
phase: 05-campus-buildings
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - js/game/sprites.js
  - js/game/world.js
autonomous: true

must_haves:
  truths:
    - "Campus has grass, paths, trees, flowers with cohesive aesthetic"
    - "Campus has central quad area for building cluster"
    - "Player spawns at entrance gate feeling of 'arriving'"
    - "Player spawns at entrance gate position on game start"
    - "Natural tree boundary at edges creates organic feel"
  artifacts:
    - path: "js/game/sprites.js"
      provides: "New tile sprites for campus decorations"
      contains: "lamppost|bench|gate|ivy"
    - path: "js/game/world.js"
      provides: "Redesigned campus layout"
      contains: "GATE|LAMPPOST|BENCH"
  key_links:
    - from: "js/game/world.js"
      to: "js/game/sprites.js"
      via: "TILES enum maps to sprite cache names"
      pattern: "getTileSprite.*spriteMap"
---

<objective>
Redesign campus map layout with central quad, entrance gate, and decorative elements.

Purpose: Create the foundational campus environment per CONTEXT.md decisions (no river, clustered buildings, lived-in feel with decorations).
Output: Updated sprites.js with new tile types and world.js with redesigned campus map.
</objective>

<execution_context>
@/home/sam/.claude/get-shit-done/workflows/execute-plan.md
@/home/sam/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/05-campus-buildings/05-CONTEXT.md
@.planning/phases/05-campus-buildings/05-RESEARCH.md
@js/game/sprites.js
@js/game/world.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add new tile types and sprites for campus decorations</name>
  <files>js/game/sprites.js, js/game/world.js</files>
  <action>
Add new tile types to World.TILES in world.js:
- GATE: 12 (entrance gate/arch)
- LAMPPOST: 13 (street lamp)
- BENCH_LEFT: 14 (park bench left half)
- BENCH_RIGHT: 15 (park bench right half)
- IVY: 16 (ivy/vines for building walls)
- COBBLE: 17 (cobblestone path variant)

Add corresponding sprite generation in sprites.js createTileSprites() or createBuildingSprites():
- gate: Stone archway, 2 tiles wide appearance using single tile (left pillar with arch)
- lamppost: Metal post with lantern top, grass background showing through
- bench: Wooden park bench, split into left/right halves for 2-tile placement
- ivy: Green vine overlay (semi-transparent feel, can layer on walls)
- cobble: Cobblestone path variant with more irregular stones than regular path

Add new colors to Sprites.colors if needed:
- metal: '#4a4a4a' (dark gray for lamppost)
- metalLight: '#6a6a6a' (highlight for lamppost)
- ivyGreen: '#3d6b3d' (darker green for ivy)

Update World.getTileSprite() spriteMap to include new tile types.

Follow existing sprite creation patterns - 16x16 pixel canvases, programmatic drawing.
  </action>
  <verify>
Check sprites exist: In browser console after loading game, verify:
- Sprites.get('gate') returns a canvas
- Sprites.get('lamppost') returns a canvas
- Sprites.get('benchLeft') returns a canvas
- Sprites.get('benchRight') returns a canvas
- World.TILES.GATE === 12
  </verify>
  <done>6 new tile types defined in World.TILES and corresponding sprites generated in Sprites.cache</done>
</task>

<task type="auto">
  <name>Task 2: Redesign campus map layout</name>
  <files>js/game/world.js</files>
  <action>
Rewrite generateCampusMap() to implement CONTEXT.md decisions:

1. Map dimensions: Keep 40x30 (verified adequate for 15-20 second crossing)

2. Remove River Cam entirely (delete the water tiles on left side)

3. Create central quad area:
   - Clear grass quad in center (roughly tiles 12-28 x 10-20)
   - Cobblestone paths forming cross pattern through quad
   - Main path from entrance (bottom) through quad to top

4. Player spawn at entrance gate:
   - Gate structure at bottom center (around x:20, y:27-28)
   - Path leading from gate into campus
   - Player spawn point: { x: 20, y: 26 } (just inside gate)

5. Natural tree boundary:
   - Dense trees around map edges (not just scattered)
   - Thicker tree line on left where river was
   - Create organic "fade to nature" at edges

6. Decorative elements for lived-in feel:
   - Benches: 3-4 placed around quad (pairs of BENCH_LEFT + BENCH_RIGHT)
   - Lampposts: 6-8 along paths (collision: true)
   - Flowers: Clusters near benches and building entrances
   - Keep some scattered trees inside campus for shade/variety

7. Building plot areas:
   - Reserve clear rectangular areas for 5 buildings (will be placed in Plan 03)
   - Approximate positions (clustered around quad):
     - Pembroke: left side of quad (x:5-10)
     - Library: top of quad (x:16-24, larger)
     - Lab: right side near top (x:28-35, modern style)
     - TV Station: right side middle (x:28-35)
     - Theatre: bottom left area (x:5-12)
   - Mark these areas with just grass for now (building exteriors in Plan 03)

8. Update spawn point: Change Player.init call or note for Engine.init to use new spawn { x: 20, y: 26 }

9. Remove old building placements:
   DELETE or COMMENT OUT these existing buildBuilding calls in generateCampusMap():
   - buildBuilding(..., 'office', 6, 9, 5, 4, "Sam's Office")
   - buildBuilding(..., 'library', 17, 14, 7, 5, "Library")
   - buildBuilding(..., 'lectureHall', 29, 9, 6, 4, "Lecture Hall")
   - buildBuilding(..., 'lab', 17, 4, 7, 4, "Research Lab")

   These 4 buildings will be replaced with 5 new buildings in Plan 03.
   Use COMMENT OUT (not delete) to preserve as reference for building placement patterns.
  </action>
  <verify>
Run npm run dev, navigate to /game:
- Player spawns near bottom of map (entrance area)
- No water/river visible on left side
- Central grassy quad area visible
- Paths form cross pattern through center
- Trees visible around edges creating natural boundary
- Benches and lampposts visible as decorations
- No buildings rendered (just grass plots where buildings will go)
  </verify>
  <done>Campus map has central quad layout, entrance gate area, decorative elements, no river, tree boundaries at edges, old buildings removed</done>
</task>

</tasks>

<verification>
- All new tile types render correctly without visual glitches
- Campus layout matches CONTEXT.md decisions (no river, central quad, entrance spawn)
- Collision works correctly on new tile types (lampposts block, benches block, gate passable)
- Player can walk around entire campus in ~15-20 seconds
- Old 4 buildings (office, library, lectureHall, lab) are NOT rendered
</verification>

<success_criteria>
- 6 new tile types (GATE, LAMPPOST, BENCH_LEFT, BENCH_RIGHT, IVY, COBBLE) with sprites
- Campus layout redesigned per CONTEXT.md
- Player spawns at entrance gate location
- Central quad clearly visible with path cross-pattern
- Natural tree boundary at edges
- Decorative elements (benches, lampposts, flowers) placed
- Old buildBuilding calls commented out (buildings rebuilt in Plan 03)
</success_criteria>

<output>
After completion, create `.planning/phases/05-campus-buildings/05-01-SUMMARY.md`
</output>
