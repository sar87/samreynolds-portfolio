---
phase: 05-campus-buildings
plan: 03
type: execute
wave: 2
depends_on: ["05-01", "05-02"]
files_modified:
  - js/game/world.js
autonomous: true

must_haves:
  truths:
    - "Five distinct buildings visible on campus with varied sizes"
    - "Each building has visible sign with name"
    - "Traditional buildings have gothic details (4 buildings)"
    - "Lab has modern architectural style (1 building)"
    - "Player can walk to any building entrance"
  artifacts:
    - path: "js/game/world.js"
      provides: "Building exterior placement and definitions"
      contains: "pembroke|library|lab|station|theatre"
  key_links:
    - from: "js/game/world.js"
      to: "World.buildings"
      via: "Building definitions with entrance coordinates"
      pattern: "entrance.*x.*y"
---

<objective>
Place five distinct building exteriors on the campus map with proper architectural styles.

Purpose: Create recognizable building exteriors per CONTEXT.md (varied sizes, traditional vs modern, signs) that players can identify and enter.
Output: world.js with 5 building exteriors using gothic (4) and modern (1) architectural sprites.
</objective>

<execution_context>
@/home/sam/.claude/get-shit-done/workflows/execute-plan.md
@/home/sam/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/05-campus-buildings/05-CONTEXT.md
@.planning/phases/05-campus-buildings/05-01-SUMMARY.md
@.planning/phases/05-campus-buildings/05-02-SUMMARY.md
@js/game/world.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update building definitions for 5 buildings</name>
  <files>js/game/world.js</files>
  <action>
Update World.buildings object to define all 5 buildings with proper positions around the central quad:

```javascript
buildings: {
  pembroke: {
    name: "Pembroke College",
    contentKey: 'about',
    entrance: { x: 9, y: 15 },  // Door position
    tiles: { x: 5, y: 11, w: 6, h: 5 },  // Building footprint
    style: 'traditional'
  },
  library: {
    name: "University Library",
    contentKey: 'publications',
    entrance: { x: 20, y: 8 },
    tiles: { x: 16, y: 4, w: 9, h: 5 },  // Larger building
    style: 'traditional'
  },
  lab: {
    name: "Research Lab",
    contentKey: 'research',
    entrance: { x: 32, y: 10 },
    tiles: { x: 28, y: 6, w: 7, h: 5 },
    style: 'modern'
  },
  station: {
    name: "TV Station",
    contentKey: 'media',
    entrance: { x: 32, y: 18 },
    tiles: { x: 28, y: 14, w: 6, h: 5 },
    style: 'traditional'
  },
  theatre: {
    name: "Lecture Theatre",
    contentKey: 'talks',
    entrance: { x: 9, y: 23 },
    tiles: { x: 5, y: 19, w: 6, h: 5 },
    style: 'traditional'
  }
}
```

Building placement rationale (clustered around central quad):
- Pembroke: Left side of quad (personal office - About/bio)
- Library: Top center, largest building (Publications)
- Lab: Right side, modern style (Research)
- Station: Right side below Lab (Media appearances)
- Theatre: Bottom left (Talks/lectures)

Sizes vary per CONTEXT.md (Library larger to indicate importance).

Delete or update old building references (office, lectureHall) to use new names.
  </action>
  <verify>
In console:
- World.buildings.pembroke exists with entrance coordinates
- World.buildings.library exists with larger w value than others
- World.buildings.lab.style === 'modern'
- All 5 buildings defined (pembroke, library, lab, station, theatre)
  </verify>
  <done>5 building definitions created with positions around central quad, varied sizes, style flags</done>
</task>

<task type="auto">
  <name>Task 2: Create building exterior rendering functions</name>
  <files>js/game/world.js</files>
  <action>
Create two helper functions for building exteriors based on style:

1. buildTraditionalBuilding(ground, objects, collision, interact, id, x, y, w, h):
   - Perimeter: ORNATE_WALL tiles for walls
   - Top row: BATTLEMENT or ROOF tiles
   - Windows: GOTHIC_WINDOW tiles at regular intervals
   - Door: GOTHIC_DOOR at entrance position
   - Add IVY tiles on some wall tiles (random or pattern)
   - Optional: SPIRE_TOP at corners for larger buildings
   - Place building sign (SIGN_PEMBROKE etc.) near entrance path

2. buildModernBuilding(ground, objects, collision, interact, id, x, y, w, h):
   - Perimeter: MODERN_WALL tiles
   - Top row: METAL_PANEL tiles
   - Windows: MODERN_WINDOW tiles (larger, more glass)
   - Door: MODERN_DOOR at entrance
   - Place SIGN_LAB near entrance
   - Clean geometric look, no ivy

Both functions should:
- Set collision[idx] = 1 for all building tiles
- Set collision to 0 for door tile (walkable)
- Set interact[doorIdx] = { type: 'door', building: id, name: ... }
- Create PATH tiles leading from quad paths to door
- Place appropriate sign tile near entrance

Note: Door interactions are set here but interiors don't exist until Wave 3 (Plans 04-05).
The game engine handles missing interiors gracefully - door interaction will work once interiors are created.
This is the expected phased build order.

Keep the existing buildBuilding() as fallback or remove if fully replaced.
  </action>
  <verify>
After implementation, check that functions exist:
- typeof World.buildTraditionalBuilding === 'function'
- typeof World.buildModernBuilding === 'function'
Functions accept correct parameters and don't throw errors when called.
Door interaction zones set (interiors will be wired in Plans 04-05).
  </verify>
  <done>buildTraditionalBuilding() and buildModernBuilding() helper functions created with appropriate sprite usage</done>
</task>

<task type="auto">
  <name>Task 3: Place all 5 building exteriors on campus map</name>
  <files>js/game/world.js</files>
  <action>
Update generateCampusMap() to place all 5 buildings using the new helper functions:

```javascript
// Place buildings around central quad
// Traditional buildings (4)
this.buildTraditionalBuilding(ground, objects, collision, interact,
  'pembroke', 5, 11, 6, 5, "Pembroke College");
this.buildTraditionalBuilding(ground, objects, collision, interact,
  'library', 16, 4, 9, 5, "University Library");
this.buildTraditionalBuilding(ground, objects, collision, interact,
  'station', 28, 14, 6, 5, "TV Station");
this.buildTraditionalBuilding(ground, objects, collision, interact,
  'theatre', 5, 19, 6, 5, "Lecture Theatre");

// Modern building (1)
this.buildModernBuilding(ground, objects, collision, interact,
  'lab', 28, 6, 7, 5, "Research Lab");
```

Ensure paths connect each building entrance to the main path network:
- Add PATH or COBBLE tiles from each door to nearest main path
- These connector paths should not have collision

Add building signs near each entrance:
- Place SIGN_PEMBROKE tile 1-2 tiles in front of Pembroke door
- Similarly for all 5 buildings
- Signs should have collision (can't walk through)

Final layout check:
- Verify no building overlaps with another
- Verify no building blocks the central quad paths
- Verify player can walk from spawn to any building entrance
  </action>
  <verify>
Run npm run dev, navigate to /game:
- All 5 buildings visible on map
- Library is visibly larger than other buildings
- Lab has distinct modern appearance (no gothic arches)
- Traditional buildings have arched windows and gothic details
- Signs visible near each building entrance
- Can walk from spawn to each building door without obstruction
- Pressing ENTER at doors shows interaction prompt (entry will work after Plans 04-05)
  </verify>
  <done>5 building exteriors placed on campus with distinct styles, signs, and accessible entrances</done>
</task>

</tasks>

<verification>
- 5 buildings visible on campus (Pembroke, Library, Lab, Station, Theatre)
- Library larger than other buildings
- Lab has modern appearance, other 4 have traditional gothic style
- Each building has visible sign near entrance
- Player can walk to and reach each building door
- Collision prevents walking through building walls
- Door tiles are walkable (collision = 0)
- Door interact zones created (interiors wired in Plans 04-05)
</verification>

<success_criteria>
- World.buildings contains 5 building definitions
- buildTraditionalBuilding() uses gothic sprites (ORNATE_WALL, GOTHIC_WINDOW, etc.)
- buildModernBuilding() uses modern sprites (MODERN_WALL, MODERN_WINDOW, etc.)
- All 5 buildings rendered on campus around central quad
- Each building has sign sprite placed near entrance
- Paths connect all building entrances to main path network
- Building sizes vary (Library largest)
</success_criteria>

<output>
After completion, create `.planning/phases/05-campus-buildings/05-03-SUMMARY.md`
</output>
