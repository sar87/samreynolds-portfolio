---
phase: 05-campus-buildings
plan: 04
type: execute
wave: 3
depends_on: ["05-03"]
files_modified:
  - js/game/world.js
  - js/game/buildings.js
autonomous: true

must_haves:
  truths:
    - "Player can enter Pembroke and see personal office interior"
    - "Player can enter Library and see bookshelves everywhere"
    - "Both interiors have clear exit points"
    - "Pembroke feels personal with desk and details"
    - "Library has grand academic feel with tall shelves"
  artifacts:
    - path: "js/game/world.js"
      provides: "Pembroke and Library interior map generation"
      contains: "generatePembrokeInterior|generateLibraryInterior"
  key_links:
    - from: "js/game/world.js"
      to: "World.interiorMaps"
      via: "Interior maps stored by building ID"
      pattern: "interiorMaps\\.pembroke|interiorMaps\\.library"
---

<objective>
Create interior maps for Pembroke College (About) and University Library (Publications).

Purpose: Implement the first two building interiors per CONTEXT.md (personal office with details, grand academic library with bookshelves).
Output: world.js with generatePembrokeInterior() and updated generateLibraryInterior() functions.
</objective>

<execution_context>
@/home/sam/.claude/get-shit-done/workflows/execute-plan.md
@/home/sam/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/05-campus-buildings/05-CONTEXT.md
@.planning/phases/05-campus-buildings/05-03-SUMMARY.md
@js/game/world.js
@js/game/buildings.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Pembroke College interior (personal office)</name>
  <files>js/game/world.js</files>
  <action>
Create or update generatePembrokeInterior() (replacing generateOfficeInterior if needed):

Dimensions: 14x12 tiles (single room per CONTEXT.md)

Layout theme: Personal academic office with "home" feel (CONTEXT.md: "special treatment with personal details")

Required elements:
1. Perimeter:
   - INT_WALL on top row
   - Collision on all edges

2. Personal workspace area (top-left):
   - DESK with COMPUTER (Sam's desk)
   - CHAIR in front of desk
   - Interaction zone: { type: 'object', id: 'desk', content: 'about.bio' }

3. Bookshelf section (right wall):
   - 4-5 BOOKSHELF tiles along right side
   - Contains research interests
   - Interaction zones: { type: 'object', id: 'bookshelf', content: 'about.research' }

4. Personal touches (Claude's discretion):
   - WINDOW tile(s) with view (decorative)
   - Plant sprite if available (or use FLOWER on floor)
   - Picture frame concept (use existing sprites creatively)
   - Could add armchair area using CHAIR

5. Exit at bottom center:
   - interact[(h-1) * w + Math.floor(w/2)] = { type: 'exit' }
   - Spawn point: { x: Math.floor(w/2), y: h - 2 }

Return object format:
```javascript
{
  name: "Pembroke College - Sam's Office",
  width: w,
  height: h,
  spawn: { x: ..., y: ... },
  layers: { ground, objects, collision, interact }
}
```

Register in generateInteriorMaps(): this.interiorMaps.pembroke = this.generatePembrokeInterior();
  </action>
  <verify>
In console after game loads:
- World.interiorMaps.pembroke exists
- World.interiorMaps.pembroke.name includes "Pembroke"
- World.interiorMaps.pembroke.spawn.x and .y are valid
Enter Pembroke in game: interior loads with desk, bookshelves visible
  </verify>
  <done>Pembroke interior created with personal office theme, desk, computer, bookshelves, exit</done>
</task>

<task type="auto">
  <name>Task 2: Enhance Library interior (grand academic feel)</name>
  <files>js/game/world.js</files>
  <action>
Update generateLibraryInterior() for "grand academic feel" per CONTEXT.md:

Dimensions: 20x14 tiles (larger room for library grandeur)

Layout theme: "Tall shelves, impressive, Cambridge library vibes"

Required elements:
1. Perimeter walls:
   - INT_WALL on top row
   - Collision on all edges

2. Massive bookshelf coverage:
   - Bookshelves along ENTIRE top wall (wall of books)
   - Two rows of central bookshelves (aisles between)
   - Bookshelves along side walls where space permits
   - Goal: "Library = bookshelves everywhere" per CONTEXT.md

3. Reading area (bottom section before exit):
   - 2-4 DESK tiles with CHAIR arrangements
   - Represents study/reading tables
   - Keep exit path clear

4. Interactive zones for publications:
   - Multiple zones along bookshelves
   - { type: 'publication', index: 0 }, { type: 'publication', index: 1 }, etc.
   - Spread across different bookshelf sections
   - At least 8-10 interaction points for publication browsing

5. Atmospheric elements:
   - WINDOW tiles on walls (light streaming in)
   - Could use LAMP if sprite exists (otherwise skip)

6. Exit at bottom center:
   - Clear path from spawn to exit
   - interact[(h-1) * w + Math.floor(w/2)] = { type: 'exit' }
   - Spawn: { x: Math.floor(w/2), y: h - 2 }

Return object format matching other interiors.

Update in generateInteriorMaps() if name changed.
  </action>
  <verify>
In console:
- World.interiorMaps.library exists
- World.interiorMaps.library.width === 20
- World.interiorMaps.library.height === 14
Enter Library in game: interior has extensive bookshelves, grand feel, reading desks visible
  </verify>
  <done>Library interior enhanced with extensive bookshelves, grand dimensions, reading area, multiple publication interaction zones</done>
</task>

<task type="auto">
  <name>Task 3: Update Buildings.js welcome messages and wire interiors</name>
  <files>js/game/buildings.js</files>
  <action>
Update Buildings.getWelcomeMessage() for new building names:

```javascript
getWelcomeMessage(buildingId) {
  const messages = {
    pembroke: "Welcome to Pembroke College! This is Sam's office. Look around to learn about Sam's background and research interests.",
    library: "Welcome to the University Library! Browse the extensive shelves to discover publications and research papers.",
    lab: "Welcome to the Research Lab! Examine the equipment to learn about current conservation AI projects.",
    station: "Welcome to the TV Station! Explore to find podcasts, interviews, and media appearances.",
    theatre: "Welcome to the Lecture Theatre! Check out recordings of talks and presentations."
  };
  return messages[buildingId] || "Welcome!";
}
```

Update getBuildingInfo() if it needs adjustment for new building IDs.

Verify existing interaction handling works with new content keys:
- pembroke -> 'about' content
- library -> 'publications' content
- These should already work via existing publication/object handlers
  </action>
  <verify>
Enter Pembroke: welcome dialog shows with Pembroke-specific message
Enter Library: welcome dialog shows with Library-specific message
Exit both buildings: returns to campus correctly
  </verify>
  <done>Building welcome messages updated for pembroke and library, interior wiring verified</done>
</task>

</tasks>

<verification>
- Can enter Pembroke from campus, interior loads
- Pembroke has personal office feel (desk, computer, personal touches)
- Can interact with objects in Pembroke, dialogs appear
- Can exit Pembroke, returns to campus near entrance
- Can enter Library from campus, interior loads
- Library feels grand with extensive bookshelves
- Can interact with bookshelves to see publications
- Can exit Library, returns to campus near entrance
</verification>

<success_criteria>
- generatePembrokeInterior() creates 14x12 personal office with desk, computer, bookshelves
- generateLibraryInterior() creates 20x14 grand library with extensive bookshelves
- Both interiors have working exit points
- Welcome messages display correctly for both buildings
- Interaction zones work for content display (about, publications)
- Player spawns at appropriate locations inside each building
</success_criteria>

<output>
After completion, create `.planning/phases/05-campus-buildings/05-04-SUMMARY.md`
</output>
