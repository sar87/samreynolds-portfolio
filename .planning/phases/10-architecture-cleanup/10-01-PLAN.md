---
phase: 10-architecture-cleanup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/main.ts
  - src/components/Header/Header.ts
  - src/components/Header/Header.module.css
autonomous: true

must_haves:
  truths:
    - "Site loads directly to main website content without landing page choice"
    - "Mode toggle button is removed from header UI"
    - "No game-related imports exist in main.ts"
    - "No console errors from game-related code"
  artifacts:
    - path: "src/main.ts"
      provides: "Simplified entry point with direct website rendering"
      contains: "renderHomePage"
      not_contains: ["CampusGame", "renderLanding", "game.css", "mode-switch"]
    - path: "src/components/Header/Header.ts"
      provides: "Header component without game toggle"
      not_contains: ["modeToggle", "GAME_ICON", "initModeToggle"]
    - path: "src/components/Header/Header.module.css"
      provides: "Header styles without modeToggle"
      not_contains: [".modeToggle"]
  key_links:
    - from: "src/main.ts"
      to: "src/pages/HomePage"
      via: "direct route handler"
      pattern: "router\\.add\\('/'.*renderHomePage"
---

<objective>
Remove all game-related imports and mode switching logic from the entry point and header, making the site load directly to the professional website.

Purpose: This is the prerequisite for archiving game files. Imports must be removed BEFORE files are moved to prevent build errors.

Output: Clean main.ts with simplified routing, Header without game toggle button.
</objective>

<execution_context>
@/home/sam/.claude/get-shit-done/workflows/execute-plan.md
@/home/sam/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/10-architecture-cleanup/10-RESEARCH.md

@src/main.ts
@src/components/Header/Header.ts
@src/components/Header/Header.module.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Simplify main.ts entry point</name>
  <files>src/main.ts</files>
  <action>
Remove all game and landing page functionality from main.ts:

1. **Remove these imports:**
   - `import './styles/game.css';`
   - `import './components/Landing/Landing.css';`
   - `import './components/Landing/LoadingScreen.css';`
   - `import { CampusGame } from './game/CampusGame';`
   - `import { renderLanding, initLanding } from './components/Landing/Landing';`
   - `import { showLoadingScreen, hideLoadingScreen } from './components/Landing/LoadingScreen';`
   - Remove `initModeToggle` from Header import (keep `renderHeader, initMobileNav`)

2. **Remove these variables/state:**
   - `landingShown` sessionStorage check
   - `currentMode` type and variable
   - `cleanupLanding` variable
   - `game` variable (CampusGame instance)
   - `homeScrollPosition` variable (keep if used by website routes)

3. **Simplify render function:**
   - Remove `initModeToggle()` call

4. **Remove these functions entirely:**
   - `transitionToMode()`
   - `renderLandingPage()`
   - `enterGameMode()`
   - `exitGameMode()`

5. **Simplify route handlers:**
   - '/' route: Direct call to `render(renderHomePage())` - no landing logic
   - Remove '/game' route entirely
   - Keep publication, talk, media routes unchanged

6. **Remove event listeners:**
   - Remove 'keydown' handler for G key game toggle
   - Remove 'mode-switch' custom event listener

7. **Keep these unchanged:**
   - Style imports (variables.css, global.css, utilities.css)
   - Router import and page imports
   - `render()` function structure (without initModeToggle)
   - Anchor navigation click handler
   - `router.init()` call

The simplified main.ts should be ~60-80 lines (down from ~300).
  </action>
  <verify>
1. Run `npm run build` - should complete without errors
2. Run `npm run dev` and open http://localhost:5173
3. Site should load directly to homepage (no landing page)
4. Browser console should have no errors about missing imports
  </verify>
  <done>
- main.ts contains no game/landing imports
- Site loads directly to homepage
- Build succeeds with no errors
  </done>
</task>

<task type="auto">
  <name>Task 2: Remove mode toggle from Header component</name>
  <files>src/components/Header/Header.ts, src/components/Header/Header.module.css</files>
  <action>
**In Header.ts:**

1. Remove the `GAME_ICON` SVG constant entirely

2. In `renderHeader()`, remove the modeToggle button:
   ```html
   <!-- REMOVE THIS ENTIRE BUTTON -->
   <button class="${styles.modeToggle}" aria-label="Play game">
     ${GAME_ICON}
     <span>Play Game</span>
   </button>
   ```

3. Remove the entire `initModeToggle` export function

4. Update the exports - only export:
   - `renderHeader`
   - `initMobileNav`

**In Header.module.css:**

Remove all modeToggle-related styles (lines 66-94 and mobile rules):
- `.modeToggle` block
- `.modeToggle:hover` block
- `.modeToggle:focus-visible` block
- `.modeToggle svg` block
- `.modeToggle span` and `.modeToggle` rules in `@media (max-width: 768px)` block

Keep all other styles intact (header, nav, mobile menu, etc.)
  </action>
  <verify>
1. Run `npm run build` - no errors
2. Run `npm run dev` and check header
3. Header should show: Logo, Nav links, Mobile menu button (on mobile)
4. NO "Play Game" button visible
5. TypeScript should not complain about missing exports
  </verify>
  <done>
- Header has no game toggle button
- initModeToggle function removed
- Header styles clean (no .modeToggle classes)
- Build passes
  </done>
</task>

<task type="auto">
  <name>Task 3: Verify clean build and site functionality</name>
  <files>None (verification only)</files>
  <action>
Run comprehensive verification:

1. `npm run build` - Verify production build succeeds
2. `npm run dev` - Start dev server
3. Test all routes work:
   - http://localhost:5173/#/ (homepage)
   - Click on a publication to test detail pages
   - Click on a talk to test talk detail
   - Click on a media item to test media detail
   - Test all header nav links (About, Research, Publications, Talks, Media)
4. Check browser console for any errors or warnings
5. Verify no references to "game", "landing", or "mode" in console output

Document any issues found. The site should function exactly as before, minus the game mode.
  </action>
  <verify>
1. `npm run build` exits with code 0
2. Dev server runs without errors
3. All navigation works
4. Console is clean (no errors/warnings from removed code)
  </verify>
  <done>
- Production build succeeds
- All website routes work
- No console errors
- Site is fully functional as professional website
  </done>
</task>

</tasks>

<verification>
After completing all tasks:

1. **Build check:** `npm run build` completes without errors
2. **Import check:** `grep -r "CampusGame\|renderLanding\|game.css" src/main.ts` returns nothing
3. **Header check:** `grep "modeToggle\|GAME_ICON" src/components/Header/` returns nothing
4. **Runtime check:** Site loads at localhost:5173, shows homepage immediately
5. **No game route:** Navigating to `#/game` shows nothing (route not registered)
</verification>

<success_criteria>
- [ ] main.ts has no game/landing imports (0 references to CampusGame, renderLanding, etc.)
- [ ] Header.ts exports only renderHeader and initMobileNav
- [ ] Header has no "Play Game" button in DOM
- [ ] Site loads directly to homepage (no landing page)
- [ ] All existing routes work (/, /publication/:id, /talk/:id, /media/:id)
- [ ] npm run build succeeds
- [ ] No console errors
</success_criteria>

<output>
After completion, create `.planning/phases/10-architecture-cleanup/10-01-SUMMARY.md`
</output>
