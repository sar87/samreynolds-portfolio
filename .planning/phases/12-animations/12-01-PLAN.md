---
phase: 12-animations
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/animations/scrollReveal.ts
  - src/animations/index.ts
  - src/styles/animations.css
  - src/styles/variables.css
  - src/main.ts
autonomous: true

must_haves:
  truths:
    - "Animation module exports initAnimations function"
    - "Animation CSS file contains scroll-reveal and stagger classes"
    - "main.ts calls initAnimations after render"
  artifacts:
    - path: "src/animations/index.ts"
      provides: "Animation initialization export"
      exports: ["initAnimations"]
    - path: "src/animations/scrollReveal.ts"
      provides: "Intersection Observer logic"
      exports: ["initScrollReveal", "initStaggeredCards"]
    - path: "src/styles/animations.css"
      provides: "@keyframes and animation utility classes"
      contains: ".scroll-reveal"
  key_links:
    - from: "src/main.ts"
      to: "src/animations/index.ts"
      via: "import and call in render()"
      pattern: "initAnimations\\(\\)"
---

<objective>
Create animation infrastructure: TypeScript module for Intersection Observer-based scroll reveals, CSS animation utilities, and integration into the render pipeline.

Purpose: Establishes the foundation for all Phase 12 animations. Without this infrastructure, scroll reveals, gradient text, and hover effects cannot be implemented or initialized after route changes.

Output: Working animation module that initializes on every page render.
</objective>

<execution_context>
@/home/sam/.claude/get-shit-done/workflows/execute-plan.md
@/home/sam/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/12-animations/12-CONTEXT.md
@.planning/phases/12-animations/12-RESEARCH.md

@src/main.ts
@src/styles/variables.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create animation timing tokens and CSS utilities</name>
  <files>src/styles/variables.css, src/styles/animations.css</files>
  <action>
1. Update `src/styles/variables.css` to add animation-specific timing tokens:
   ```css
   /* Animation timing - snappy Linear-style */
   --animation-duration-fast: 150ms;
   --animation-duration-normal: 250ms;
   --animation-duration-slow: 400ms;
   --animation-duration-reveal: 600ms;
   --animation-easing-out: cubic-bezier(0.33, 1, 0.68, 1);
   --animation-easing-bounce: cubic-bezier(0.34, 1.56, 0.64, 1);

   /* Stagger timing for card grids */
   --stagger-delay: 50ms;

   /* Gradient colors for animated text */
   --gradient-start: var(--color-gray-900);
   --gradient-mid: var(--color-accent);
   --gradient-end: var(--color-gray-900);
   ```

2. Create `src/styles/animations.css` with:
   - Scroll reveal base classes (.scroll-reveal, .scroll-reveal-left, .scroll-reveal-right)
   - Revealed state (.revealed)
   - Stagger utility using CSS custom property (--animation-order)
   - @keyframes for gradient-shift animation
   - .gradient-text class for gradient headings
   - All animations wrapped in @media (prefers-reduced-motion: no-preference)
   - Fallback styles for reduced-motion users (instant visibility, no transforms)

Reference the research patterns in 12-RESEARCH.md for exact CSS structure.
  </action>
  <verify>
- File `src/styles/animations.css` exists
- Contains `.scroll-reveal` class with opacity: 0 and transform
- Contains `.revealed` class with opacity: 1
- Contains `@media (prefers-reduced-motion: no-preference)` wrapper
- Contains `@keyframes gradient-shift`
  </verify>
  <done>
Animation CSS file created with scroll-reveal classes, gradient-shift keyframes, and proper reduced-motion handling.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create TypeScript animation module</name>
  <files>src/animations/scrollReveal.ts, src/animations/index.ts</files>
  <action>
1. Create `src/animations/scrollReveal.ts`:
   - Export `initScrollReveal()` function that:
     - Selects all `.scroll-reveal` elements
     - Creates IntersectionObserver with threshold: 0.15
     - On intersection: adds `.revealed` class and unobserves (one-time animation)
     - Handles alternating slide direction by setting `data-slide-from` attribute

   - Export `initStaggeredCards()` function that:
     - Selects all `[data-stagger]` containers
     - For each card inside, sets `--animation-order` CSS custom property to its index
     - This enables staggered reveal timing via CSS calc()

2. Create `src/animations/index.ts`:
   - Import initScrollReveal and initStaggeredCards from scrollReveal.ts
   - Export `initAnimations()` function that calls both initializers
   - This single entry point is what main.ts will import

Use strict TypeScript types for IntersectionObserverEntry and Element.
  </action>
  <verify>
- Run `npx tsc --noEmit` - no TypeScript errors
- File `src/animations/index.ts` exports `initAnimations`
- File `src/animations/scrollReveal.ts` exports `initScrollReveal` and `initStaggeredCards`
  </verify>
  <done>
TypeScript animation module created with Intersection Observer logic for scroll reveals and staggered card animations.
  </done>
</task>

<task type="auto">
  <name>Task 3: Wire animation initialization into render pipeline</name>
  <files>src/main.ts</files>
  <action>
1. Add import at top of main.ts:
   ```typescript
   import './styles/animations.css';
   import { initAnimations } from './animations';
   ```

2. In the `render()` function, call `initAnimations()` AFTER `app.innerHTML` is set and `initMobileNav()` is called:
   ```typescript
   async function render(content: string | Promise<string>): Promise<void> {
     const html = await content;
     const headerHtml = renderHeader();
     app!.innerHTML = `${headerHtml}<div id="content">${html}</div>`;
     initMobileNav();
     initAnimations(); // NEW: Initialize animations after DOM update
     // ... rest of function
   }
   ```

This ensures animations are re-initialized on every route change, which is necessary because the DOM is replaced on navigation.
  </action>
  <verify>
- Run `npm run dev` - dev server starts without errors
- Check browser console - no import errors
- Run `npm run build` - production build succeeds
  </verify>
  <done>
Animation module imported in main.ts and initAnimations() called in render pipeline after DOM updates.
  </done>
</task>

</tasks>

<verification>
1. `npm run build` completes without errors
2. `npx tsc --noEmit` passes
3. Animation CSS file exists at `src/styles/animations.css`
4. Animation module exists at `src/animations/index.ts`
5. main.ts imports and calls initAnimations()
</verification>

<success_criteria>
- Animation infrastructure files created and type-checked
- CSS contains scroll-reveal, revealed, and gradient-text classes
- CSS respects prefers-reduced-motion
- initAnimations() is called on every render
- Build passes without errors
</success_criteria>

<output>
After completion, create `.planning/phases/12-animations/12-01-SUMMARY.md`
</output>
